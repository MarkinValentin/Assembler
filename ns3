#include "ns3/core-module.h"
#include "ns3/network-module.h"
#include "ns3/mobility-module.h"
#include "ns3/lte-module.h"

using namespace ns3;

int main (int argc, char *argv[])
{
    // Установка логирования
    LogComponentEnable ("LteHelper", LOG_LEVEL_DEBUG);

    // Создание сценария
    Ptr<LteHelper> lteHelper = CreateObject<LteHelper> ();

    // Установка параметров сценария
    lteHelper->SetAttribute ("PathlossModel", StringValue ("ns3::FriisPropagationLossModel"));

    // Создание eNB
    NodeContainer enbNodes;
    enbNodes.Create (1);
    Ptr<Node> enb = enbNodes.Get (0);
    NetDeviceContainer enbDevs = lteHelper->InstallEnbDevice (enb);

    // Создание абонентов
    NodeContainer ueNodes;
    ueNodes.Create (2);
    Ptr<Node> ue1 = ueNodes.Get (0);
    Ptr<Node> ue2 = ueNodes.Get (1);
    NetDeviceContainer ueDevs = lteHelper->InstallUeDevice (ueNodes);

    // Установка мобильности абонентов
    MobilityHelper mobility;
    mobility.SetMobilityModel ("ns3::ConstantPositionMobilityModel");
    mobility.Install (ueNodes);

    // Подключение абонентов к eNB
    for (uint32_t i = 0; i < ueNodes.GetN (); ++i)
    {
        lteHelper->Attach (ueDevs.Get (i), enbDevs.Get (0));
    }

    // Запуск симуляции
    Simulator::Stop (Seconds (10));
    Simulator::Run ();
    Simulator::Destroy ();

    return 0;
}
